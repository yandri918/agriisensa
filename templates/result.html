<!DOCTYPE html>
<html>
<head>
    <title>Hasil Prediksi - AgriSensa</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #e8f5e9; }
        .container { max-width: 700px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h1 { color: #2e7d32; }
        .result { background: #f1f8e9; padding: 15px; border-left: 5px solid #689f38; margin: 20px 0; }
        .rekomendasi { background: #fff3e0; padding: 15px; border-left: 5px solid #ef6c00; }
        .analysis { background: #e3f2fd; padding: 15px; border-left: 5px solid #2196f3; }
        a { color: #1b5e20; text-decoration: none; font-weight: bold; }
        a:hover { text-decoration: underline; }
        .image-preview { max-width: 200px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>📊 Hasil Prediksi</h1>
        <p><strong>Input:</strong> pH={{ ph }}, N={{ n }}, P={{ p }}, K={{ k }}</p>

        <div class="result">
            <p><strong>📈 Prediksi Hasil Panen:</strong> {{ hasil }} kg</p>
            <p><strong>🌱 Status Tanah:</strong> {{ status }}</p>
            <p><strong>🌤️ Cuaca:</strong> {{ cuaca }}</p>
            <p><strong>🌧️ Musim:</strong> {{ musim }}</p>
            <p><strong>🌱 Jenis Tanaman:</strong> {{ jenis_tanaman }}</p>
            <p><strong>🤖 Model:</strong> {{ model_used }}</p>
        </div>

        {% if leaf_analysis %}
        <div class="analysis">
            <h3>🔍 Analisis Daun</h3>
            <p><strong>Warna Daun:</strong> {{ leaf_analysis.color_analysis }}</p>
            {% if leaf_analysis.image_path %}
            <p><strong>Gambar Daun:</strong></p>
            <img src="/uploads/{{ leaf_analysis.image_path }}" alt="Gambar Daun" class="image-preview">
            {% endif %}
        </div>
        {% endif %}

        {% if disease_result %}
        <div class="analysis">
            <h3>🩺 Deteksi Penyakit</h3>
            {% if disease_result.error %}
            <p><strong>Error:</strong> {{ disease_result.error }}</p>
            {% else %}
            <p><strong>Penyakit Terdeteksi:</strong> {{ disease_result.disease }}</p>
            <p><strong>Confidence:</strong> {{ "%.2f"|format(disease_result.confidence * 100) }}%</p>
            {% endif %}
        </div>
        {% endif %}

        <div class="rekomendasi">
            <p><strong>💡 Rekomendasi:</strong></p>
            <ul>
                {% for rec in rekomendasi %}
                <li>{{ rec }}</li>
                {% endfor %}
            </ul>
        </div>

        <p><a href="/">← Kembali ke Form</a></p>
    </div>
</body>
</html>